
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width,initial-scale=1">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <meta name="lang:clipboard.copy" content="Copy to clipboard">
  <meta name="lang:clipboard.copied" content="Copied to clipboard">
  <meta name="lang:search.language" content="en">
  <meta name="lang:search.pipeline.stopwords" content="True">
  <meta name="lang:search.pipeline.trimmer" content="True">
  <meta name="lang:search.result.none" content="No matching documents">
  <meta name="lang:search.result.one" content="1 matching document">
  <meta name="lang:search.result.other" content="# matching documents">
  <meta name="lang:search.tokenizer" content="[\s\-]+">

  
    <link href="https://fonts.gstatic.com/" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto+Mono:400,500,700|Roboto:300,400,400i,700&display=fallback" rel="stylesheet">

    <style>
      body,
      input {
        font-family: "Roboto", "Helvetica Neue", Helvetica, Arial, sans-serif
      }

      code,
      kbd,
      pre {
        font-family: "Roboto Mono", "Courier New", Courier, monospace
      }
    </style>
  

  <link rel="stylesheet" href="../_static/stylesheets/application.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-palette.css"/>
  <link rel="stylesheet" href="../_static/stylesheets/application-fixes.css"/>
  
  <link rel="stylesheet" href="../_static/fonts/material-icons.css"/>
  
  <meta name="theme-color" content="#3f51b5">
  <script src="../_static/javascripts/modernizr.js"></script>
  
  <script>
      window.ga = window.ga || function () {
          (ga.q = ga.q || []).push(arguments)
      };
      ga.l = +new Date;
      ga('create', 'G-F9LD9HL8LW', 'auto');
      ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  
  
    <title>Kompute Pi4 Mesa Build Example &#8212; Kompute Documentation (Python &amp; C++)</title>
    <link rel="stylesheet" href="../_static/material.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/assets/custom.css" />
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/language_data.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Kompute Game Engine Integration (Godot)" href="game-engine-godot.html" />
    <link rel="prev" title="Kompute Mobile App Integration (Android)" href="mobile-android.html" />
  
   

  </head>
  <body dir=ltr
        data-md-color-primary=red data-md-color-accent=light-blue>
  
  <svg class="md-svg">
    <defs data-children-count="0">
      
      <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
      
    </defs>
  </svg>
  
  <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer">
  <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search">
  <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
  <a href="#overview/raspberry-pi" tabindex="1" class="md-skip"> Skip to content </a>
  <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex navheader">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="../index.html" title="Kompute Documentation (Python &amp; C++)"
           class="md-header-nav__button md-logo">
          
            &nbsp;
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          <span class="md-header-nav__topic">Kompute Documentation (Python & C++)</span>
          <span class="md-header-nav__topic"> Kompute Pi4 Mesa Build Example </span>
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
        
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" action="../search.html" method="GET" name="search">
      <input type="text" class="md-search__input" name="q" placeholder="Search"
             autocapitalize="off" autocomplete="off" spellcheck="false"
             data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>

      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            <a href="https://github.com/KomputeProject/kompute/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Kompute
  </div>
</a>
          </div>
        </div>
      
      
  
  <script src="../_static/javascripts/version_dropdown.js"></script>
  <script>
    var json_loc = "../"versions.json"",
        target_loc = "../../",
        text = "Versions";
    $( document ).ready( add_version_dropdown(json_loc, target_loc, text));
  </script>
  

    </div>
  </nav>
</header>

  
  <div class="md-container">
    
    
    
  <nav class="md-tabs" data-md-component="tabs">
    <div class="md-tabs__inner md-grid">
      <ul class="md-tabs__list">
          <li class="md-tabs__item"><a href="../index.html" class="md-tabs__link">Kompute Documentation (Python & C++)</a></li>
            
            <li class="md-tabs__item"><a href="https://github.com/KomputeProject/kompute/" class="md-tabs__link">Kompute Repo</a></li>
      </ul>
    </div>
  </nav>
    <main class="md-main">
      <div class="md-main__inner md-grid" data-md-component="container">
        
          <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="../index.html" title="Kompute Documentation (Python &amp; C++)" class="md-nav__button md-logo">
      
        <img src="../_static/" alt=" logo" width="48" height="48">
      
    </a>
    <a href="../index.html"
       title="Kompute Documentation (Python &amp; C++)">Kompute Documentation (Python & C++)</a>
  </label>
    <div class="md-nav__source">
      <a href="https://github.com/KomputeProject/kompute/" title="Go to repository" class="md-source" data-md-source="github">

    <div class="md-source__icon">
      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24" width="28" height="28">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Kompute
  </div>
</a>
    </div>
  
  

  
  <ul class="md-nav__list">
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">C++ Documentation:</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="https://kompute.cc/" class="md-nav__link">Documentation Home</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="community.html" class="md-nav__link">Community Meetings, Discord & Links</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">C++ Documentation:</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="advanced-examples.html" class="md-nav__link">C++ Examples</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="memory-management.html" class="md-nav__link">Memory Management Principles</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="build-system.html" class="md-nav__link">Build System Deep Dive</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="shaders-to-headers.html" class="md-nav__link">Processing Shaders (Online & Offline)</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="custom-operations.html" class="md-nav__link">Extending Kompute with Custom Operations</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="reference.html" class="md-nav__link">C++ Class Documentation & Reference</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="https://kompute.cc/codecov/" class="md-nav__link">Test Code Coverage</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Python Documentation:</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="python-package.html" class="md-nav__link">Python Package Overview</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="python-reference.html" class="md-nav__link">Python Class Documentation & Reference</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Examples:</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="python-examples.html" class="md-nav__link">Python Examples</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="advanced-examples.html" class="md-nav__link">C++ Examples</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="mobile-android.html" class="md-nav__link">Android Mobile App Integration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    <label class="md-nav__link md-nav__link--active" for="__toc"> Edge Device Raspberry Pi Mesa Drivers </label>
    
      <a href="#" class="md-nav__link md-nav__link--active">Edge Device Raspberry Pi Mesa Drivers</a>
      
        
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#overview-raspberry-pi--page-root" class="md-nav__link">Kompute Pi4 Mesa Build Example</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#raspberry-pi-operating-system" class="md-nav__link">Raspberry Pi Operating System</a>
        </li>
        <li class="md-nav__item"><a href="#running-the-pi-headless" class="md-nav__link">Running the Pi headless</a>
        </li>
        <li class="md-nav__item"><a href="#ensure-all-packages-are-using-the-latest-version" class="md-nav__link">Ensure all packages are using the latest version</a>
        </li>
        <li class="md-nav__item"><a href="#install-dependencies-for-building-mesa-and-running-kompute" class="md-nav__link">Install dependencies for building mesa and running Kompute</a>
        </li>
        <li class="md-nav__item"><a href="#clone-mesa-repository" class="md-nav__link">Clone mesa repository</a>
        </li>
        <li class="md-nav__item"><a href="#build-mesa" class="md-nav__link">Build mesa</a>
        </li>
        <li class="md-nav__item"><a href="#configure-preferred-vulkan-sdk-driver" class="md-nav__link">Configure preferred Vulkan SDK driver</a>
        </li>
        <li class="md-nav__item"><a href="#allow-access-to-render" class="md-nav__link">Allow access to render</a>
        </li>
        <li class="md-nav__item"><a href="#confirm-correct-vulkan-sdk-operation" class="md-nav__link">Confirm correct Vulkan SDK operation</a>
        </li>
        <li class="md-nav__item"><a href="#clone-kompute" class="md-nav__link">Clone Kompute</a>
        </li>
        <li class="md-nav__item"><a href="#install-dependencies-to-run-the-tests" class="md-nav__link">Install dependencies to run the tests</a>
        </li>
        <li class="md-nav__item"><a href="#run-the-available-tests" class="md-nav__link">Run the available tests</a>
        </li>
        <li class="md-nav__item"><a href="#closing-remarks" class="md-nav__link">Closing remarks</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/overview/raspberry-pi.rst.txt">Show Source</a> </li>

  </ul>
</nav>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="game-engine-godot.html" class="md-nav__link">Game Engine Godot Integration</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="matmul-benchmark.html" class="md-nav__link">Example Benchmark with Matrix Multiplication</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="convolutional-net.html" class="md-nav__link">Convolutional Neural Network (CNN) Simple Upscale</a>
      
    
    </li>
    <li class="md-nav__item">
    
      <span class="md-nav__link caption"><span class="caption-text">Advanced Concepts &amp; Deep Dives:</span></span>
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="ci-tests.html" class="md-nav__link">CI, Docker Images Docs & Tests</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="variable-types.html" class="md-nav__link">Variable Types for Tensors, and Push/Spec Constants</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="async-parallel.html" class="md-nav__link">Asynchronous & Parallel Operations</a>
      
    
    </li>
    <li class="md-nav__item">
    
    
      <a href="../genindex.html" class="md-nav__link">Code Index</a>
      
    
    </li>
  </ul>
  

</nav>
              </div>
            </div>
          </div>
          <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
            <div class="md-sidebar__scrollwrap">
              <div class="md-sidebar__inner">
                
<nav class="md-nav md-nav--secondary">
    <label class="md-nav__title" for="__toc">Contents</label>
  <ul class="md-nav__list" data-md-scrollfix="">
        <li class="md-nav__item"><a href="#overview-raspberry-pi--page-root" class="md-nav__link">Kompute Pi4 Mesa Build Example</a><nav class="md-nav">
              <ul class="md-nav__list">
        <li class="md-nav__item"><a href="#raspberry-pi-operating-system" class="md-nav__link">Raspberry Pi Operating System</a>
        </li>
        <li class="md-nav__item"><a href="#running-the-pi-headless" class="md-nav__link">Running the Pi headless</a>
        </li>
        <li class="md-nav__item"><a href="#ensure-all-packages-are-using-the-latest-version" class="md-nav__link">Ensure all packages are using the latest version</a>
        </li>
        <li class="md-nav__item"><a href="#install-dependencies-for-building-mesa-and-running-kompute" class="md-nav__link">Install dependencies for building mesa and running Kompute</a>
        </li>
        <li class="md-nav__item"><a href="#clone-mesa-repository" class="md-nav__link">Clone mesa repository</a>
        </li>
        <li class="md-nav__item"><a href="#build-mesa" class="md-nav__link">Build mesa</a>
        </li>
        <li class="md-nav__item"><a href="#configure-preferred-vulkan-sdk-driver" class="md-nav__link">Configure preferred Vulkan SDK driver</a>
        </li>
        <li class="md-nav__item"><a href="#allow-access-to-render" class="md-nav__link">Allow access to render</a>
        </li>
        <li class="md-nav__item"><a href="#confirm-correct-vulkan-sdk-operation" class="md-nav__link">Confirm correct Vulkan SDK operation</a>
        </li>
        <li class="md-nav__item"><a href="#clone-kompute" class="md-nav__link">Clone Kompute</a>
        </li>
        <li class="md-nav__item"><a href="#install-dependencies-to-run-the-tests" class="md-nav__link">Install dependencies to run the tests</a>
        </li>
        <li class="md-nav__item"><a href="#run-the-available-tests" class="md-nav__link">Run the available tests</a>
        </li>
        <li class="md-nav__item"><a href="#closing-remarks" class="md-nav__link">Closing remarks</a>
        </li></ul>
            </nav>
        </li>
    
<li class="md-nav__item"><a class="md-nav__extra_link" href="../_sources/overview/raspberry-pi.rst.txt">Show Source</a> </li>

<li id="searchbox" class="md-nav__item"></li>

  </ul>
</nav>
              </div>
            </div>
          </div>
        
        <div class="md-content">
          <article class="md-content__inner md-typeset" role="main">
            
  <section id="kompute-pi4-mesa-build-example">
<h1 id="overview-raspberry-pi--page-root">Kompute Pi4 Mesa Build Example<a class="headerlink" href="#overview-raspberry-pi--page-root" title="Permalink to this headline">¶</a></h1>
<p>The Raspberry Pi 4 is an impressive little computer when you consider that the Broadcom GPU is able to run 2x 4K displays. This example intends to show how to get Kompute up and running on a Raspberry Pi 4. This has huge potential for edge processing using the power of the Pi 4 GPU.</p>
<p>Special thanks to <a class="reference external" href="https://blogs.igalia.com/apinheiro/">Alejandro Piñeiro</a> and others for their work on Broadcom drivers for <a class="reference external" href="https://gitlab.freedesktop.org/mesa/mesa">Mesa</a> which make this example possible.</p>
<section id="raspberry-pi-operating-system">
<h2 id="raspberry-pi-operating-system">Raspberry Pi Operating System<a class="headerlink" href="#raspberry-pi-operating-system" title="Permalink to this headline">¶</a></h2>
<p>For this experiment we used <a class="reference external" href="https://downloads.raspberrypi.org/raspios_lite_armhf/images/raspios_lite_armhf-2021-01-12/2021-01-11-raspios-buster-armhf-lite.zip">RaspiOS Lite 2021-01-12</a>, though it is likely best to start with the latest available operation system from <a class="reference external" href="https://www.raspberrypi.org/software/operating-systems/">Raspberry Pi operating system images</a>. In other experiments the full Raspberry Pi operating system (with desktop environment) was found to work. However, when attempting to use Ubuntu on the Raspberry Pi we were not able to run the Python Kompute examples.</p>
</section>
<section id="running-the-pi-headless">
<h2 id="running-the-pi-headless">Running the Pi headless<a class="headerlink" href="#running-the-pi-headless" title="Permalink to this headline">¶</a></h2>
<p>By far the easiest way to get up and running with a Raspberry Pi is to configure it for headless operation. This removes the requirement to have a monitor, keyboard or mouse. To run headless the Pi needs access to the internet and for SSH enabled. The following guides from the Raspberry Pi foundation should help.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.raspberrypi.org/documentation/configuration/wireless/headless.md">Setting up a Raspberry Pi headless</a></p></li>
<li><p><a class="reference external" href="https://www.raspberrypi.org/documentation/remote-access/ssh/">SSH (Secure Shell)</a></p></li>
</ul>
</section>
<section id="ensure-all-packages-are-using-the-latest-version">
<h2 id="ensure-all-packages-are-using-the-latest-version">Ensure all packages are using the latest version<a class="headerlink" href="#ensure-all-packages-are-using-the-latest-version" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">update</span>
<span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">upgrade</span>
</pre></div>
</div>
</section>
<section id="install-dependencies-for-building-mesa-and-running-kompute">
<h2 id="install-dependencies-for-building-mesa-and-running-kompute">Install dependencies for building mesa and running Kompute<a class="headerlink" href="#install-dependencies-for-building-mesa-and-running-kompute" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span><span class="o">-</span><span class="n">get</span> <span class="n">install</span> \
    <span class="n">git</span> <span class="n">build</span><span class="o">-</span><span class="n">essential</span> <span class="n">cmake</span> \
    <span class="n">python3</span><span class="o">-</span><span class="n">dev</span> <span class="n">python3</span><span class="o">-</span><span class="n">mako</span> <span class="n">python3</span><span class="o">-</span><span class="n">venv</span> \
    <span class="n">flex</span> <span class="n">bison</span> <span class="n">meson</span> <span class="n">ninja</span><span class="o">-</span><span class="n">build</span> \
    <span class="n">libxcb</span><span class="o">-</span><span class="n">shm0</span><span class="o">-</span><span class="n">dev</span> <span class="n">libxcb1</span><span class="o">-</span><span class="n">dev</span> <span class="n">libxcb</span><span class="o">-*-</span><span class="n">dev</span> \
    <span class="n">libx11</span><span class="o">-</span><span class="n">dev</span> <span class="n">libx11</span><span class="o">-</span><span class="n">xcb</span><span class="o">-</span><span class="n">dev</span> <span class="n">x11proto</span><span class="o">-</span><span class="n">dri2</span><span class="o">-</span><span class="n">dev</span> <span class="n">x11proto</span><span class="o">-</span><span class="n">dri3</span><span class="o">-</span><span class="n">dev</span> \
    <span class="n">libdrm</span><span class="o">-</span><span class="n">dev</span> <span class="n">libxshmfence</span><span class="o">-</span><span class="n">dev</span> <span class="n">libxrandr</span><span class="o">-</span><span class="n">dev</span> <span class="n">libxfixes</span><span class="o">-</span><span class="n">dev</span> \
    <span class="n">vulkan</span><span class="o">-</span><span class="n">tools</span> <span class="n">libvulkan</span><span class="o">-</span><span class="n">dev</span>
</pre></div>
</div>
</section>
<section id="clone-mesa-repository">
<h2 id="clone-mesa-repository">Clone mesa repository<a class="headerlink" href="#clone-mesa-repository" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="o">--</span><span class="n">depth</span> <span class="mi">1</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">gitlab</span><span class="o">.</span><span class="n">freedesktop</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">mesa</span><span class="o">/</span><span class="n">mesa</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</section>
<section id="build-mesa">
<h2 id="build-mesa">Build mesa<a class="headerlink" href="#build-mesa" title="Permalink to this headline">¶</a></h2>
<p>Use meson and ninja to build mesa using the Broadcom Vulkan SDK drivers. For information on the Gallium drivers please see <a class="reference external" href="https://docs.mesa3d.org/drivers/v3d.html">V3D — The Mesa 3D Graphics Library latest documentation</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">meson</span> <span class="o">--</span><span class="n">libdir</span> <span class="n">lib</span> \
    <span class="o">--</span><span class="n">prefix</span> <span class="o">/</span><span class="n">mesa</span><span class="o">-</span><span class="n">install</span> \
    <span class="o">-</span><span class="n">D</span> <span class="n">platforms</span><span class="o">=</span><span class="n">x11</span> \
    <span class="o">-</span><span class="n">D</span> <span class="n">vulkan</span><span class="o">-</span><span class="n">drivers</span><span class="o">=</span><span class="n">broadcom</span> \
    <span class="o">-</span><span class="n">D</span> <span class="n">gallium</span><span class="o">-</span><span class="n">drivers</span><span class="o">=</span><span class="n">v3d</span> \
    <span class="o">-</span><span class="n">D</span> <span class="n">dri</span><span class="o">-</span><span class="n">drivers</span><span class="o">=</span><span class="p">[]</span> \
    <span class="o">-</span><span class="n">D</span> <span class="n">buildtype</span><span class="o">=</span><span class="n">debug</span> \
    <span class="n">build</span>

<span class="n">ninja</span> <span class="o">-</span><span class="n">C</span> <span class="n">build</span>
<span class="n">sudo</span> <span class="n">ninja</span> <span class="o">-</span><span class="n">C</span> <span class="n">build</span> <span class="n">install</span>
</pre></div>
</div>
</section>
<section id="configure-preferred-vulkan-sdk-driver">
<h2 id="configure-preferred-vulkan-sdk-driver">Configure preferred Vulkan SDK driver<a class="headerlink" href="#configure-preferred-vulkan-sdk-driver" title="Permalink to this headline">¶</a></h2>
<p>Export the path for the Broadcom drivers, this command will need to be run for every new terminal session.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">VK_ICD_FILENAMES</span><span class="o">=/</span><span class="n">mesa</span><span class="o">-</span><span class="n">install</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">vulkan</span><span class="o">/</span><span class="n">icd</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">broadcom_icd</span><span class="o">.</span><span class="n">armv7l</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
</section>
<section id="allow-access-to-render">
<h2 id="allow-access-to-render">Allow access to render<a class="headerlink" href="#allow-access-to-render" title="Permalink to this headline">¶</a></h2>
<p>In order to access the render from remote login there are two options. Both options work.</p>
<p><strong>Option 1: provide read write access to everyone.</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">chmod</span> <span class="n">ugo</span><span class="o">+</span><span class="n">rw</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">dri</span><span class="o">/</span><span class="n">renderD128</span>
</pre></div>
</div>
<p><strong>Option 2: Change group from render to video.</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">chown</span> <span class="n">root</span><span class="p">:</span><span class="n">video</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">dri</span><span class="o">/</span><span class="n">renderD128</span>
</pre></div>
</div>
</section>
<section id="confirm-correct-vulkan-sdk-operation">
<h2 id="confirm-correct-vulkan-sdk-operation">Confirm correct Vulkan SDK operation<a class="headerlink" href="#confirm-correct-vulkan-sdk-operation" title="Permalink to this headline">¶</a></h2>
<p>To confirm that mesa was configured and built correctly run the following command.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vulkaninfo</span>
</pre></div>
</div>
</section>
<section id="clone-kompute">
<h2 id="clone-kompute">Clone Kompute<a class="headerlink" href="#clone-kompute" title="Permalink to this headline">¶</a></h2>
<p>Clone Kompute for access to the latest Python tests.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">git</span> <span class="n">clone</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">KomputeProject</span><span class="o">/</span><span class="n">kompute</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</section>
<section id="install-dependencies-to-run-the-tests">
<h2 id="install-dependencies-to-run-the-tests">Install dependencies to run the tests<a class="headerlink" href="#install-dependencies-to-run-the-tests" title="Permalink to this headline">¶</a></h2>
<p>Navigate to the available tests and install required dependencies.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="n">kompute</span><span class="o">/</span><span class="n">python</span><span class="o">/</span><span class="n">test</span>
<span class="n">python3</span> <span class="o">-</span><span class="n">m</span> <span class="n">venv</span> <span class="o">.</span><span class="n">venv</span>
<span class="n">source</span> <span class="o">.</span><span class="n">venv</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">activate</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">upgrade</span> <span class="n">pip</span> <span class="n">wheel</span>
<span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">r</span> <span class="n">requirements</span><span class="o">-</span><span class="n">dev</span><span class="o">.</span><span class="n">txt</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">git</span><span class="o">+</span><span class="n">git</span><span class="p">:</span><span class="o">//</span><span class="n">github</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">KomputeProject</span><span class="o">/</span><span class="n">kompute</span><span class="o">.</span><span class="n">git</span>
</pre></div>
</div>
</section>
<section id="run-the-available-tests">
<h2 id="run-the-available-tests">Run the available tests<a class="headerlink" href="#run-the-available-tests" title="Permalink to this headline">¶</a></h2>
<p>Use the following command to run the python tests for Kompute.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span>
</pre></div>
</div>
<p>If the tests pass then congratulations! You are now able to make full use of the Pi 4 Broadcom GPU for running parallel computing. If however, there are any issues with the tests they can be run in debug mode to see the logs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pytest</span> <span class="o">--</span><span class="n">log</span><span class="o">-</span><span class="n">cli</span><span class="o">-</span><span class="n">level</span> <span class="n">debug</span>
</pre></div>
</div>
<p>Please share any issues with the maintainers and they will be more than happy to help.</p>
</section>
<section id="closing-remarks">
<h2 id="closing-remarks">Closing remarks<a class="headerlink" href="#closing-remarks" title="Permalink to this headline">¶</a></h2>
<p>To avoid the need to export <code class="docutils literal notranslate"><span class="pre">VK_ICD_FILENAMES</span></code> every time you login, it is possible to symlink the json file into the default directory. The Vulkan SDK loader looks in the <code class="docutils literal notranslate"><span class="pre">/etc/vulkan/icd.d/</span></code> directory for <code class="docutils literal notranslate"><span class="pre">.json</span></code> files.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">ln</span> <span class="o">-</span><span class="n">s</span> <span class="o">/</span><span class="n">mesa</span><span class="o">-</span><span class="n">install</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">vulkan</span><span class="o">/</span><span class="n">icd</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">broadcom_icd</span><span class="o">.</span><span class="n">armv7l</span><span class="o">.</span><span class="n">json</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">vulkan</span><span class="o">/</span><span class="n">icd</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="n">broadcom_icd</span><span class="o">.</span><span class="n">armv7l</span><span class="o">.</span><span class="n">json</span>
</pre></div>
</div>
<p>As a word of warning, configuring the icd filenames in this way will stop certain tests being skipped. At the time of writing this will mean that some tests fail when running on the Pi.</p>
</section>
</section>


          </article>
        </div>
      </div>
    </main>
  </div>
  <footer class="md-footer">
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
          
            <a href="mobile-android.html" title="Kompute Mobile App Integration (Android)"
               class="md-flex md-footer-nav__link md-footer-nav__link--prev"
               rel="prev">
              <div class="md-flex__cell md-flex__cell--shrink">
                <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
              </div>
              <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
                <span class="md-flex__ellipsis">
                  <span
                      class="md-footer-nav__direction"> Previous </span> Kompute Mobile App Integration (Android) </span>
              </div>
            </a>
          
          
            <a href="game-engine-godot.html" title="Kompute Game Engine Integration (Godot)"
               class="md-flex md-footer-nav__link md-footer-nav__link--next"
               rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title"><span
                class="md-flex__ellipsis"> <span
                class="md-footer-nav__direction"> Next </span> Kompute Game Engine Integration (Godot) </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink"><i
                class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          
        </a>
        
      </nav>
    </div>
    <div class="md-footer-meta md-typeset">
      <div class="md-footer-meta__inner md-grid">
        <div class="md-footer-copyright">
          <div class="md-footer-copyright__highlight">
              &#169; Copyright 2020, The Institute for Ethical AI &amp; Machine Learning.
              
          </div>
            Created using
            <a href="http://www.sphinx-doc.org/">Sphinx</a> 3.2.1.
             and
            <a href="https://github.com/bashtage/sphinx-material/">Material for
              Sphinx</a>
        </div>
      </div>
    </div>
  </footer>
  <script src="../_static/javascripts/application.js"></script>
  <script>app.initialize({version: "1.0.4", url: {base: ".."}})</script>
  </body>
</html>